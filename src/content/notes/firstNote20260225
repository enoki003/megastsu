---
title: "このサイトの設計から開発まで”
description: "本サイトの技術スタック、デザイン面の工夫やターゲット層などを解説する。"
date: 2026-02-25
draft: false
---
# 1.概要
ポートフォリオ兼研究ノートサイトを作成した。
使用技術には、コンテンツ駆動型の静的サイトジェネレーターであるAstroを採用し、高速かつ保守性の高いサイトを実現した。
また、デプロイの効率化のために、本サイトで使用しているレンタルサーバーに自動デプロイするCI/CDパイプラインをGitHub Actionsを用い構築した。これによって、長期的に記事を投稿できる環境と、高い拡張性と保守性を実現できた。本記事ではその背景から設計、今後の課題や反省まで詳細に記述する。

# 2.導入
研究活動や学習記録を継続的に蓄積・公開するにあたり、既存のSNSや外部ブログサービスでは、長期的な整理性や設計自由度の面で制約があると感じていた。私の関心領域は分野横断的であり、単発の発表や一時的な登壇では継続的な文脈共有が難しい。さらに、研究者・企業関係者・共同開発者に対して、自分の取り組みや技術的背景を一貫した形で提示できる方法を探していた。これらを踏まえ、自己紹介・研究ノート・ポートフォリオを統合した独自サイトの設計および開発を行った。

# 3.要件定義
## 3.1.目的
本サイトは、私の研究活動及び学習記録を長期的に蓄積・公開すると同時に、自己紹介およびポートフォリオとして機能させることを目的とする。

## 3.2.機能要件
本サイトが満たすべき機能要件は以下のとおりである。
### 3.2.1.記事管理機能
- Markdown形式またはその他の形式で記事を作成できること
- 記事の公開/非公開を切り替えられること
- 記事本体にメタデータを付与できること

### 3.2.2.コンテンツ分離機能
- タグやカテゴリにより分類が可能であること
- Note（学術寄り）とJournal（ブログ寄り）を分離して個別に確立すること

### 3.2.3.更新機能
- 記事作成から公開までに要するステップ数を少なくすること
- 書いている途中の記事を定期的に保存できるようにすること
- 記事の整理がしやすいようにすること

## 3.3.非機能要件
本サイトの非機能要件は以下である。
### 3.3.1.性能要件
- クライアント側に余計な負荷をかけないこと（JavaScriptの使用を最小限に抑えること）
- 高速に表示できること
- 低帯域環境でも表示できるようにすること

### 3.3.2.保守要件
- コンテンツとレイアウトを分離できるようにすること
- 機能を拡張しやすい設計にすること

### 3.3.3.運用コスト
- デプロイ作業を自動化すること

### 3.3.4.セキュリティ
- 不要な通信を避けること
- SSH鍵が漏洩しないようにすること

## 3.4.制約
本サイトには以下の制約が存在する。
- ホスティング環境はさくらのレンタルサーバである。
- 開発から運用、保守はすべて一人である。
- 大規模なトラフィックを想定しない
- 予算はサーバ代のみとする。
- 開発期間を短くすること

# 4.技術と手法
## 4.1.Astroによる実装
### 4.1.1.フレームワークの選定理由
今回は、コンテンツ駆動型のWebサイトジェネレーターであるAstroを採用した。理由として、雛形が充実しており、学習コストを抑えて迅速に作成ができること、クライアントにJavaScriptなどの処理による負荷をかけないこと、Markdownやその他のソースを取り込める基盤が整っていることが挙げられる。また、あくまで記事がメインであり、複雑な実装を要さない。

## 4.2.CI/CDパイプライン
### 4.2.1.選定理由
一人で記事の投稿と保守をしていくので、CI/CD（継続的インテグレーション／継続的デリバリー）パイプラインの実装が必要であると考えた。
そこで、今回はGitHub上で管理できることから、GitHub Actionsでの実装を選定した。

### 4.2.2.デプロイメントのフロー
本サイトのCI/CDはGitHub Actionsにより自動化している。ワークフローは `push` および `pull_request` をトリガーとして起動するが、本番環境へのデプロイは `master` ブランチへの `push`（= PRのmerge後）でのみ実行される。

**トリガーと実行範囲**
- pull_request（対象: master）: ビルドと検証のみ（デプロイは実行しない）
- push（対象: master）: ビルドと検証に加え、本番デプロイまで実行する

**CIフェーズ（PR / push 共通）**
1. リポジトリをcheckoutする（actions/checkout）。
2. Node.js 20をセットアップし、npmキャッシュを有効化する（actions/setup-node）。
3. 依存関係をクリーンインストールする（npm ci）。
4. Astroのビルドを実行し、成果物を `dist/` に生成する（npm run build）。
5. 成果物の最低条件を検証する（`dist/index.html` の存在チェック）。

**CDフェーズ（push to master のみ）**

6. known_hosts をSecretsから配置し、SSH接続先のなりすましを防止する（StrictHostKeyChecking有効）。
7. ssh-agentを起動し、Secretsで管理するデプロイ用秘密鍵をロードする。
8. デプロイ対象ディレクトリにマーカー（`.deploy-root`）が存在することを検証し、誤配備を防ぐ。
9. rsyncで `dist/` をデプロイ先へ同期し、不要になった旧ファイルは `--delete` で削除する（マーカーは除外）。

この構成により、PR段階では安全にビルド検証のみを行い、master反映時のみ本番更新することで、運用時のエラーを提言できる。


## 　4.3.記事獲得機能
本サイトのNote及びJournalで使われている、特定のディレクトリからMDファイルをフェッチし、記事一覧として表示する機能について解説する。

### 4.3.1. Contents Collections
AstroにはContent Collectionsという専用の機能が用意されている。